# Аналіз вразливостей програмного продукту за OWASP Top 10 2021

## Таблиця 3 – Результати аналізу вимог до програмного застосування

| Ідентифікатор та назва атаки (вразливості) | Вимога (FR, NFR) | Приклад вразливостей, які може використовувати атака | Приклад запобігання успішної реалізації атаки |
|-------------------------------------------|------------------|---------------------------------------------------|------------------------------------------------|
| A1 – Broken Access Control (недоліки контролю доступу) | FR2 – Керування обліковими записами користувачів | Обхід перевірок авторизації, маніпуляції з URL для доступу до чужих даних, підвищення привілеїв | Реалізація принципу "заборонено за замовчуванням", перевірка дозволів на сервері, логування спроб несанкціонованого доступу |
| A1 – Broken Access Control (недоліки контролю доступу) | FR1 – Дистанційне керування обладнанням | Несанкціонований доступ до команд керування, обхід перевірок прав доступу до критичного обладнання | Багаторівневий контроль доступу, автентифікація перед кожною критичною операцією |
| A2 – Cryptographic Failures (невдачі у криптографії) | NFR5 – Аутентифікація користувачів | Слабкі алгоритми хешування паролів, незахищене зберігання криптографічних ключів, використання застарілих протоколів | Використання сучасних алгоритмів (bcrypt, scrypt), безпечне зберігання ключів у HSM, шифрування даних в спокої |
| A2 – Cryptographic Failures (невдачі у криптографії) | FR6 – Інтеграція зі SCADA-системами | Незашифрована передача даних SCADA, слабке шифрування промислових протоколів | Використання TLS для всіх з'єднань, шифрування промислових протоколів |
| A3 – Injection (впровадження) | FR3 – Ведення журналу подій | SQL injection через параметри логування, command injection через записи журналу | Параметризовані запити, валідація вхідних даних, використання ORM |
| A3 – Injection (впровадження) | FR1 – Дистанційне керування обладнанням | Command injection через параметри керування обладнанням, LDAP injection | Валідація і санітизація всіх вхідних параметрів, використання безпечних API |
| A4 – Insecure Design (небезпечний дизайн) | NFR1 – Безпека системи | Відсутність моделі загроз, неврахування принципів secure by design | Проведення аналізу загроз на етапі дизайну, впровадження defense in depth |
| A4 – Insecure Design (небезпечний дизайн) | FR4 – Моніторинг помилок та попереджень | Відсутність rate limiting, неправильна архітектура системи сповіщень | Впровадження rate limiting, проектування з урахуванням принципів безпеки |
| A5 – Security Misconfiguration (неправильна конфігурація безпеки) | NFR1 – Безпека системи | Залишені за замовчуванням паролі, невимкнені debug режими, невірні налаштування CORS | Використання конфігураційних шаблонів, автоматизація налаштувань безпеки |
| A5 – Security Misconfiguration (неправильна конфігурація безпеки) | FR6 – Інтеграція зі SCADA-системами | Незахищені SCADA протоколи, відкриті порти, невірні налаштування firewall | Регулярний аудит конфігурації, закриття невикористовуваних портів |
| A6 – Vulnerable and Outdated Components (вразливі та застарілі компоненти) | NFR2 – Продуктивність системи | Використання застарілих бібліотек з відомими вразливостями, відсутність оновлень | Регулярний моніторинг вразливостей, автоматизоване оновлення залежностей |
| A6 – Vulnerable and Outdated Components (вразливі та застарілі компоненти) | FR6 – Інтеграція зі SCADA-системами | Застарілі SCADA драйвери, вразливі промислові протоколи | Регулярне оновлення SCADA компонентів, моніторинг безпеки промислових систем |
| A7 – Identification and Authentication Failures (помилки ідентифікації та аутентифікації) | NFR5 – Аутентифікація користувачів | Слабкі паролі, відсутність MFA, session hijacking | Політика сильних паролів, впровадження 2FA/MFA, захищені сесії |
| A7 – Identification and Authentication Failures (помилки ідентифікації та аутентифікації) | FR2 – Керування обліковими записами користувачів | Brute force атаки, credential stuffing, session fixation | Account lockout після невдалих спроб, CAPTCHA, secure session management |
| A8 – Software and Data Integrity Failures (невдачі у забезпеченні цілісності) | FR3 – Ведення журналу подій | Підробка логів, незахищені CI/CD pipeline, небезпечна десеріалізація | Цифровий підпис логів, захист CI/CD, валідація десеріалізованих об'єктів |
| A8 – Software and Data Integrity Failures (невдачі у забезпеченні цілісності) | FR1 – Дистанційне керування обладнанням | Підробка команд керування, компрометація integrity даних SCADA | Цифровий підпис команд, checksums для критичних даних |
| A9 – Security Logging and Monitoring Failures (невдачі реєстрації та моніторингу) | FR3 – Ведення журналу подій | Недостатнє логування критичних подій, відсутність моніторингу атак | Централізоване логування, SIEM системи, alerting на підозрілу активність |
| A9 – Security Logging and Monitoring Failures (невдачі реєстрації та моніторингу) | FR4 – Моніторинг помилок та попереджень | Відсутність detection несанкціонованої активності, повільна реакція на інциденти | Real-time моніторинг, автоматичні системи виявлення вторгнень |
| A10 – Server-Side Request Forgery (підробка запитів на стороні сервера) | FR6 – Інтеграція зі SCADA-системами | SSRF атаки через інтеграційні endpoint'и, доступ до внутрішніх SCADA систем | Валідація URL, використання whitelist дозволених хостів, network segmentation |
| A10 – Server-Side Request Forgery (підробка запитів на стороні сервера) | FR5 – Відображення схеми станції в реальному часі | SSRF через API отримання даних від зовнішніх джерел, атаки на внутрішню мережу | Фільтрація запитів до внутрішніх ресурсів, використання проксі для зовнішніх запитів |

## Розшифровка абревіатур:
- **MFA** - Multi-Factor Authentication (Багатофакторна аутентифікація)
- **2FA** - Two-Factor Authentication (Двофакторна аутентифікація)
- **CORS** - Cross-Origin Resource Sharing (Спільне використання ресурсів між різними джерелами)
- **HSM** - Hardware Security Module (Модуль апаратної безпеки)
- **TLS** - Transport Layer Security (Безпека транспортного рівня)
- **SCADA** - Supervisory Control and Data Acquisition (Диспетчерський контроль і збір даних)
- **CI/CD** - Continuous Integration/Continuous Deployment (Безперервна інтеграція/Безперервне розгортання)
- **SIEM** - Security Information and Event Management (Управління інформацією та подіями безпеки)
- **SSRF** - Server-Side Request Forgery (Підробка запитів на стороні сервера)
- **API** - Application Programming Interface (Інтерфейс прикладного програмування)
- **ORM** - Object-Relational Mapping (Об'єктно-реляційне відображення)
- **LDAP** - Lightweight Directory Access Protocol (Полегшений протокол доступу до каталогів)