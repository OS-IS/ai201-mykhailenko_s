# 4.7.8 Тестування ін'єкції SSI (WSTG-INPV-08)

## Резюме
Веб-сервери зазвичай надають розробникам можливість додавати невеликі фрагменти динамічного коду всередину статичних HTML-сторінок, не маючи справи з повноцінними серверними або клієнтськими мовами. Ця функція забезпечується за допомогою Server-Side Includes (SSI).

Server-Side Includes - це директиви, які веб-сервер обробляє перед надсиланням сторінки користувачу. Вони являють собою альтернативу написанню CGI-програм або вбудовуванню коду за допомогою серверних мов сценаріїв, коли потрібно виконувати лише дуже прості завдання. Поширені реалізації SSI надають директиви (команди) для включення зовнішніх файлів, встановлення та виведення змінних середовища CGI веб-сервера або виконання зовнішніх CGI-сценаріїв чи системних команд.

SSI може призвести до віддаленого виконання команд (RCE), однак більшість веб-серверів мають директиву `exec` вимкненою за замовчуванням.

Це вразливість, дуже схожа на класичну вразливість ін'єкції мови сценаріїв. Одним із способів пом'якшення є те, що веб-сервер повинен бути налаштований для підтримки SSI. З іншого боку, вразливості ін'єкції SSI часто простіше експлуатувати, оскільки директиви SSI легко зрозуміти і, водночас, досить потужні, наприклад, вони можуть виводити вміст файлів і виконувати системні команди.

## Цілі тестування
- Виявити точки ін'єкції SSI.
- Оцінити серйозність ін'єкції.

## Як тестувати
Для тестування експлуатованого SSI введіть директиви SSI як користувацький ввід. Якщо SSI увімкнено і валідація користувацького вводу не реалізована належним чином, сервер виконає директиву. Це дуже схоже на класичну вразливість ін'єкції мови сценаріїв, оскільки вона виникає, коли користувацький ввід не перевіряється і не санітизується належним чином.

Спочатку визначте, чи підтримує веб-сервер директиви SSI. Часто відповідь позитивна, оскільки підтримка SSI досить поширена. Щоб визначити, чи підтримуються директиви SSI, дізнайтеся тип веб-сервера, на якому працює ціль, використовуючи техніки збору інформації.

Іншим способом перевірки того, що директиви SSI увімкнені, є перевірка сторінок з розширенням .shtml, яке пов'язане з директивами SSI. Використання розширення .shtml не є обов'язковим, тому відсутність файлів .shtml не обов'язково означає, що ціль не вразлива до атак ін'єкції SSI.

Наступний крок - визначення всіх можливих векторів користувацького вводу та тестування, щоб перевірити, чи є ін'єкція SSI експлуатованою. Спочатку знайдіть всі сторінки, де дозволено користувацький ввід. Можливі вектори вводу можуть також включати заголовки та куки.

## Приклади тестових навантажень
Поширені тестові навантаження для ін'єкції SSI включають:
- `<!--#echo var="DATE_LOCAL" -->`
- `<!--#include file="robots.txt"-->`
- `<!--#exec cmd="/bin/ps ax"-->`
- `<!--#include virtual="/proc/version"-->`